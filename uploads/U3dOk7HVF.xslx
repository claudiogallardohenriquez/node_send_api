ActiveRecord::ConnectionTimeoutError at /api/web/v1/download_file
=================================================================

> could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use

app/controllers/api/web/v1/api_controller.rb, line 31
-----------------------------------------------------

``` ruby
   26           user_token = request.headers["X-User-Token"]
   27         end
   28   
   29         valid_token = false
   30         if user_email && user_token
>  31           @user = User.where(email: user_email).first ? User.where(email: user_email).first : nil
   32           if @user
   33             valid_token = @user.valid_token? user_token
   34           end
   35         else
   36           @user = nil
```

App backtrace
-------------

 - app/controllers/api/web/v1/api_controller.rb:31:in `authenticate_user_from_token!'

Full backtrace
--------------

 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:201:in `block in wait_poll'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in `wait_poll'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:151:in `internal_poll'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:277:in `internal_poll'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:145:in `block in poll'
 - /Users/2b-0134/.rbenv/versions/2.3.0/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:155:in `synchronize'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:145:in `poll'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:818:in `acquire_connection'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:538:in `checkout'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'
 - activerecord (5.2.4.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:1033:in `retrieve_connection'
 - activerecord (5.2.4.3) lib/active_record/connection_handling.rb:118:in `retrieve_connection'
 - activerecord (5.2.4.3) lib/active_record/connection_handling.rb:90:in `connection'
 - activerecord (5.2.4.3) lib/active_record/relation/delegation.rb:76:in `connection'
 - activerecord (5.2.4.3) lib/active_record/relation/query_methods.rb:934:in `build_arel'
 - activerecord (5.2.4.3) lib/active_record/relation/query_methods.rb:900:in `arel'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:560:in `block in exec_queries'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:584:in `skip_query_cache_if_necessary'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:547:in `exec_queries'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:422:in `load'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:200:in `records'
 - activerecord (5.2.4.3) lib/active_record/relation.rb:195:in `to_ary'
 - activerecord (5.2.4.3) lib/active_record/relation/finder_methods.rb:532:in `find_nth_with_limit'
 - activerecord (5.2.4.3) lib/active_record/relation/finder_methods.rb:517:in `find_nth'
 - activerecord (5.2.4.3) lib/active_record/relation/finder_methods.rb:125:in `first'
 - app/controllers/api/web/v1/api_controller.rb:31:in `authenticate_user_from_token!'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:426:in `block in make_lambda'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:179:in `block (2 levels) in halting_and_conditional'
 - actionpack (5.2.4.3) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:180:in `block in halting_and_conditional'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:513:in `block in invoke_before'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:513:in `invoke_before'
 - activesupport (5.2.4.3) lib/active_support/callbacks.rb:131:in `run_callbacks'
 - actionpack (5.2.4.3) lib/abstract_controller/callbacks.rb:41:in `process_action'
 - actionpack (5.2.4.3) lib/action_controller/metal/rescue.rb:22:in `process_action'
 - actionpack (5.2.4.3) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'
 - activesupport (5.2.4.3) lib/active_support/notifications.rb:168:in `block in instrument'
 - activesupport (5.2.4.3) lib/active_support/notifications/instrumenter.rb:23:in `instrument'
 - activesupport (5.2.4.3) lib/active_support/notifications.rb:168:in `instrument'
 - actionpack (5.2.4.3) lib/action_controller/metal/instrumentation.rb:32:in `process_action'
 - actionpack (5.2.4.3) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'
 - activerecord (5.2.4.3) lib/active_record/railties/controller_runtime.rb:24:in `process_action'
 - actionpack (5.2.4.3) lib/abstract_controller/base.rb:134:in `process'
 - actionview (5.2.4.3) lib/action_view/rendering.rb:32:in `process'
 - actionpack (5.2.4.3) lib/action_controller/metal/live.rb:255:in `block (2 levels) in process'
 - activesupport (5.2.4.3) lib/active_support/dependencies/interlock.rb:42:in `block in running'
 - activesupport (5.2.4.3) lib/active_support/concurrency/share_lock.rb:162:in `sharing'
 - activesupport (5.2.4.3) lib/active_support/dependencies/interlock.rb:41:in `running'
 - actionpack (5.2.4.3) lib/action_controller/metal/live.rb:247:in `block in process'
 - actionpack (5.2.4.3) lib/action_controller/metal/live.rb:291:in `block in new_controller_thread'

